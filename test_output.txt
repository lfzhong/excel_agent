=== 示例1：通用代码生成（无Excel数据）===
问题：计算斐波那契数列的前10个数字并打印出来

=== 生成的代码 ===
import numpy as np

# 定义一个函数来计算斐波那契数列
def fibonacci(n):
    # 初始化前两个斐波那契数
    fib_sequence = [0, 1]
    # 计算后续的斐波那契数
    for i in range(2, n):
        next_fib = fib_sequence[i-1] + fib_sequence[i-2]
        fib_sequence.append(next_fib)
    return fib_sequence

# 计算前10个斐波那契数
fib_numbers = fibonacci(10)

# 打印结果
print(fib_numbers)

=== 执行结果 ===
[0, 1, 1, 2, 3, 5, 8, 13, 21, 34]


==================================================

=== 示例2：通用代码生成（包含Excel数据）===
[{'表四': {'labels': [1, 2], 'header': [3, 4]}}]
问题：分析Excel文件中的数据，计算基本统计信息
Excel文件：files/公共预算支出增长统计.xlsx

=== 数据上下文 ===
可用数据信息：{
  "表四": {
    "columns": [
      "省(区、市、县)",
      "幼儿园-2022年",
      "幼儿园-增长率（%）",
      "普通小学-2022年",
      "普通小学-增长率（%）",
      "普通初中-2022年",
      "普通初中-增长率（%）",
      "普通高中-2022年",
      "普通高中-增长率（%）",
      "中等职业学校-2022年",
      "中等职业学校-增长率（%）",
      "普通高等学校-2022年",
      "普通高等学校-增长率（%）"
    ],
    "shape": [
      36,
      13
    ],
    "sample_data": [
      {
        "省(区、市、县)": "  宁夏回族自治区",
        "幼儿园-2022年": 5617.34,
        "幼儿园-增长率（%）": -19.85,
        "普通小学-2022年": 3995.06,
        "普通小学-增长率（%）": -10.91,
        "普通初中-2022年": 5526.65,
        "普通初中-增长率（%）": -14.25,
        "普通高中-2022年": 5052.4,
        "普通高中-增长率（%）": -20.32,
        "中等职业学校-2022年": 9750.02,
        "中等职业学校-增长率（%）": -15.46,
        "普通高等学校-2022年": 11038.65,
        "普通高等学校-增长率（%）": -18.01
      },
      {
        "省(区、市、县)": "      宁夏回族自治区本级",
        "幼儿园-2022年": 4283.91,
        "幼儿园-增长率（%）": 50.16,
        "普通小学-2022年": 11127.0,
        "普通小学-增长率（%）": 24.87,
        "普通初中-2022年": 27526.89,
        "普通初中-增长率（%）": 1.24,
        "普通高中-2022年": 6367.71,
        "普通高中-增长率（%）": 3.12,
        "中等职业学校-2022年": 9418.88,
        "中等职业学校-增长率（%）": 1.88,
        "普通高等学校-2022年": 11187.48,
        "普通高等学校-增长率（%）": -19.52
      },
      {
        "省(区、市、县)": "    银川市",
        "幼儿园-2022年": 4599.44,
        "幼儿园-增长率（%）": -39.45,
        "普通小学-2022年": 3260.58,
        "普通小学-增长率（%）": -27.8,
        "普通初中-2022年": 4535.75,
        "普通初中-增长率（%）": -12.99,
        "普通高中-2022年": 3885.75,
        "普通高中-增长率（%）": -31.09,
        "中等职业学校-2022年": 9166.26,
        "中等职业学校-增长率（%）": 17.84,
        "普通高等学校-2022年": 6462.98,
        "普通高等学校-增长率（%）": -23.89
      }
    ],
    "dtypes": {
      "省(区、市、县)": "object",
      "幼儿园-2022年": "float64",
      "幼儿园-增长率（%）": "float64",
      "普通小学-2022年": "float64",
      "普通小学-增长率（%）": "float64",
      "普通初中-2022年": "float64",
      "普通初中-增长率（%）": "float64",
      "普通高中-2022年": "float64",
      "普通高中-增长率（%）": "float64",
      "中等职业学校-2022年": "float64",
      "中等职业学校-增长率（%）": "float64",
      "普通高等学校-2022年": "float64",
      "普通高等学校-增长率（%）": "float64"
    }
  }
}

=== 生成的代码 ===
# 数据注入 - 自动生成
import pandas as pd
import io
# 将DataFrame转换为CSV字符串然后重新加载
csv_data_表四 = '''省(区、市、县),幼儿园-2022年,幼儿园-增长率（%）,普通小学-2022年,普通小学-增长率（%）,普通初中-2022年,普通初中-增长率（%）,普通高中-2022年,普通高中-增长率（%）,中等职业学校-2022年,中等职业学校-增长率（%）,普通高等学校-2022年,普通高等学校-增长率（%）
  宁夏回族自治区,5617.34,-19.85,3995.06,-10.91,5526.65,-14.25,5052.4,-20.32,9750.02,-15.46,11038.65,-18.01
      宁夏回族自治区本级,4283.91,50.16,11127.0,24.87,27526.89,1.24,6367.71,3.12,9418.88,1.88,11187.48,-19.52
    银川市,4599.44,-39.45,3260.58,-27.8,4535.75,-12.99,3885.75,-31.09,9166.26,17.84,6462.98,-23.89
      银川市本级,3979.85,11.15,3013.13,-15.79,2772.22,-0.96,3536.52,-17.35,10747.41,76.69,6462.98,-23.89
      兴庆区,2066.83,-57.72,3018.46,-26.55,3093.25,-25.55,5787.41,68.88,0.0,,0.0,
      西夏区,4410.9,-43.39,3502.77,-36.96,5059.86,-38.28,0.0,,0.0,,0.0,
      金凤区,5480.9,-53.25,4121.5,-39.16,8055.99,-37.73,0.0,,0.0,,0.0,
      永宁县,7110.51,49.31,2696.0,-11.06,6316.96,135.8,4541.42,-3.04,17999.43,-4.64,0.0,
      贺兰县,3393.9,-61.92,2120.74,-47.64,4068.74,-42.78,4320.59,-68.73,0.0,,0.0,
      灵武市,7658.51,2.5,4399.26,20.22,6817.29,2.33,3744.51,30.17,5941.37,-42.11,0.0,
    石嘴山市,8390.76,12.8,4539.51,12.97,4684.03,-14.17,6350.71,-35.07,7765.83,-31.79,21531.69,20.17
      石嘴山市本级,4750.99,68.5,0.0,,5428.73,1.44,7043.59,-37.13,8294.61,-15.34,21531.69,20.17
      大武口区,12219.22,4.92,4996.29,56.66,3705.12,12.22,0.0,,0.0,,0.0,
      惠农区,11116.42,14.37,6205.76,48.98,8405.43,46.8,0.0,,0.0,,0.0,
      平罗县,6161.63,14.88,3245.12,-31.07,3499.34,-48.96,5395.72,-30.7,7161.51,-47.65,0.0,
    吴忠市,8623.23,-12.28,4253.62,-2.43,5769.97,-9.25,5876.66,-6.15,15387.94,-9.6,5726.68,-16.61
      吴忠市本级,9115.03,-40.11,5117.86,4.05,5480.49,-6.98,4633.41,-19.94,2308.25,0.14,5726.68,-16.61
      利通区,15981.75,9.08,5339.06,24.29,10285.37,45.4,0.0,,0.0,,0.0,
      红寺堡区,11447.3,1.34,6361.16,-17.14,8022.26,-29.73,7332.24,-6.24,20448.61,3.84,0.0,
      盐池县,13937.34,8.39,7662.68,25.96,7494.16,25.0,10916.71,8.94,34191.21,-12.91,0.0,
      同心县,1148.07,-78.11,2145.92,-17.56,4089.5,0.73,6853.12,5.65,18344.32,1.37,0.0,
      青铜峡市,6096.63,-24.02,1275.46,-48.96,3952.04,-27.09,2472.81,-20.18,9150.08,-37.35,0.0,
    固原市,5679.52,-8.16,4387.42,-11.49,6417.11,-22.28,5000.91,-20.62,9255.24,-38.01,0.0,
      固原市本级,12098.26,-66.36,4465.77,46.97,9893.52,-29.95,4658.67,-26.21,9230.51,-49.67,0.0,
      原州区,6887.96,19.53,3540.99,-11.94,3867.73,-29.05,2189.04,58.85,0.0,,0.0,
      西吉县,7127.74,-7.18,3698.8,-25.78,5472.93,-33.23,6951.04,-20.04,7975.98,-30.28,0.0,
      隆德县,1435.14,0.63,5468.11,0.13,9959.08,0.88,4883.95,2.26,17761.71,0.05,0.0,
      泾源县,1897.01,3.18,10959.04,28.77,4487.41,9.86,5529.59,13.37,10964.82,18.96,0.0,
      彭阳县,4532.43,-13.38,4180.61,-32.33,13118.22,-10.31,3136.96,-41.77,6653.59,-60.75,0.0,
    中卫市,2960.27,-25.23,3781.38,-1.7,5261.5,-12.94,3791.36,-32.12,8075.32,-19.57,0.0,
      中卫市本级,9795.04,8.96,4618.74,-57.57,8098.14,15.23,2634.68,-36.76,4253.03,-59.88,0.0,
      沙坡头区,1591.71,-57.48,3807.48,26.35,6479.49,-8.17,0.0,,0.0,,0.0,
      中宁县,1829.37,-46.32,4202.26,2.69,5446.99,-29.52,4197.33,-21.28,11985.16,-6.84,0.0,
      海原县,3669.11,8.31,3358.76,6.29,3924.04,-1.31,4499.96,-36.53,10219.96,40.82,0.0,
    宁东能源化工基地,25165.9,-49.64,6647.18,6.84,7562.78,-3.27,0.0,,0.0,,0.0,
      宁东能源化工基地本级,25165.9,-49.64,6647.18,6.84,7562.78,-3.27,0.0,,0.0,,0.0,
'''
df_表四 = pd.read_csv(io.StringIO(csv_data_表四))
print(f'已加载数据表: 表四 -> df_表四')

# 用户生成的代码
import pandas as pd

# 假设数据已经加载为df_表四
# 计算基本统计信息
statistics = df_表四.describe()

# 输出统计信息
print(statistics)

=== 执行结果 ===ERROR:excel_agent.backend.pipeline.dismantle_excel:Excel 处理报错：
[Errno 2] No such file or directory: 'files/sales_data.xlsx'
Traceback (most recent call last):
  File "/Users/fangzhongliu/Documents/python_projects/HW6/excel_agent/backend/pipeline/dismantle_excel.py", line 107, in unmerge_and_fill_excel
    wb = openpyxl.load_workbook(input_path, data_only=True)
  File "/Users/fangzhongliu/Documents/python_projects/HW6/excel_agent/venv/lib/python3.13/site-packages/openpyxl/reader/excel.py", line 346, in load_workbook
    reader = ExcelReader(filename, read_only, keep_vba,
                         data_only, keep_links, rich_text)
  File "/Users/fangzhongliu/Documents/python_projects/HW6/excel_agent/venv/lib/python3.13/site-packages/openpyxl/reader/excel.py", line 123, in __init__
    self.archive = _validate_archive(fn)
                   ~~~~~~~~~~~~~~~~~^^^^
  File "/Users/fangzhongliu/Documents/python_projects/HW6/excel_agent/venv/lib/python3.13/site-packages/openpyxl/reader/excel.py", line 95, in _validate_archive
    archive = ZipFile(filename, 'r')
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/zipfile/__init__.py", line 1367, in __init__
    self.fp = io.open(file, filemode)
              ~~~~~~~^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'files/sales_data.xlsx'
ERROR:excel_agent.backend.pipeline.dismantle_excel:拆解复杂表头报错cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "/Users/fangzhongliu/Documents/python_projects/HW6/excel_agent/backend/pipeline/dismantle_excel.py", line 205, in main_unmerge_file
    _, merged_info = unmerge_and_fill_excel(input_file, unmerged_file)
    ^^^^^^^^^^^^^^
TypeError: cannot unpack non-iterable NoneType object

已加载数据表: 表四 -> df_表四
          幼儿园-2022年  幼儿园-增长率（%）    普通小学-2022年  普通小学-增长率（%）    普通初中-2022年  \
count     36.000000   36.000000     36.000000    35.000000     36.000000   
mean    7428.495000  -12.930000   4504.462778    -3.741714   6726.160000   
std     5729.771827   35.071621   2214.670564    28.632312   4245.848116   
min     1148.070000  -78.110000      0.000000   -57.570000   2772.220000   
25%     3902.165000  -44.122500   3334.215000   -26.165000   4387.932500   
50%     5888.075000   -7.670000   4191.435000    -2.430000   5503.570000   
75%     9285.032500    8.990000   5173.160000    16.595000   7677.650000   
max    25165.900000   68.500000  11127.000000    56.660000  27526.890000   

       普通初中-增长率（%）    普通高中-2022年  普通高中-增长率（%）  中等职业学校-2022年  中等职业学校-增长率（%）  \
count    36.000000     36.000000    28.000000     36.000000      25.000000   
mean     -5.419167   3932.910278   -12.143929   7845.862500     -12.810400   
std      32.698048   2661.897206    29.545383   7563.620361      31.544728   
min     -48.960000      0.000000   -68.730000      0.000000     -60.750000   
25%     -27.580000   2401.867500   -31.347500      0.000000     -37.350000   
50%      -8.710000   4410.275000   -20.110000   8025.650000     -12.910000   
75%       1.290000   5594.045000     2.475000  10351.822500       1.370000   
max     135.800000  10916.710000    68.880000  34191.210000      76.690000   

       普通高等学校-2022年  普通高等学校-增长率（%）  
count     36.000000       8.000000  
mean    2490.800833      -9.773750  
std     5606.174156      18.700982  
min        0.000000     -23.890000  
25%        0.000000     -20.612500  
50%        0.000000     -17.310000  
75%        0.000000      -7.415000  
max    21531.690000      20.170000  


==================================================

=== 示例3：结构化Excel分析（原有功能）===
错误：Excel文件预处理失败
